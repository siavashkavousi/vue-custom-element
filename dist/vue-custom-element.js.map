{"version":3,"file":"vue-custom-element.js","sources":["../node_modules/set-prototype-of/index.js","../src/utils/isES2015.js","../src/utils/registerCustomElement.js","../src/utils/helpers.js","../src/utils/props.js","../src/utils/slots.js","../src/utils/customEvent.js","../src/utils/createVueInstance.js","../src/vue-custom-element.js"],"sourcesContent":["/**\n * ES6 Object.getPrototypeOf Polyfill\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/setPrototypeOf\n */\n\nObject.setPrototypeOf = Object.setPrototypeOf || setPrototypeOf\n\nfunction setPrototypeOf (obj, proto) {\n  obj.__proto__ = proto\n  return obj\n}\n\nmodule.exports = setPrototypeOf.bind(Object)\n","function isES2015() {\n  if (typeof Symbol === 'undefined' || typeof Reflect === 'undefined') return false;\n\n  return true;\n}\n\nexport default isES2015();\n","import 'set-prototype-of'; // polyfill for older browsers (IE < 11) that do not support Object.setPrototypeOf needed by Webpack's transpiled ES2015 \"class\", even if it's not directly used\nimport isES2015 from './isES2015';\n\nexport default function registerCustomElement(tag, options = {}) {\n  if (typeof customElements === 'undefined') { return; } // eslint-disable-line\n\n  function constructorCallback() {\n    if (options.shadow === true && HTMLElement.prototype.attachShadow) {\n      this.attachShadow({ mode: 'open' });\n    }\n    typeof options.constructorCallback === 'function' && options.constructorCallback.call(this);\n  }\n  function connectedCallback() {\n    typeof options.connectedCallback === 'function' && options.connectedCallback.call(this);\n  }\n\n  function disconnectedCallback() {\n    typeof options.disconnectedCallback === 'function' && options.disconnectedCallback.call(this);\n  }\n\n  function attributeChangedCallback(name, oldValue, value) {\n    typeof options.attributeChangedCallback === 'function' && options.attributeChangedCallback.call(this, name, oldValue, value);\n  }\n\n  if (isES2015) {\n    // ES2015 detected. We will use \"class\" based Custom Elements V1 specification.\n    // If it's natively supported it will run without polyfill\n    class CustomElement extends HTMLElement {\n      // Can define constructor arguments if you wish.\n      constructor(self) {\n        super();\n\n        const me = self ? HTMLElement.call(self) : this;\n\n        constructorCallback.call(me);\n        return me;\n      }\n\n      static get observedAttributes() {\n        return options.observedAttributes || [];\n      }\n    }\n\n    CustomElement.prototype.connectedCallback = connectedCallback;\n    CustomElement.prototype.disconnectedCallback = disconnectedCallback;\n    CustomElement.prototype.attributeChangedCallback = attributeChangedCallback;\n\n    customElements.define(tag, CustomElement);\n    return CustomElement; // eslint-disable-line consistent-return\n  } else { // eslint-disable-line no-else-return\n    // not ES2015. We will use polyfill supported version of registering Custom Elements\n    // so older browsers could handle it\n    function CustomElement(self) { // eslint-disable-line no-inner-declarations\n      const me = self ? HTMLElement.call(self) : this;\n\n      constructorCallback.call(me);\n      return me;\n    }\n\n    CustomElement.observedAttributes = options.observedAttributes || [];\n\n    CustomElement.prototype = Object.create(\n      HTMLElement.prototype, {\n        constructor: {\n          configurable: true,\n          writable: true,\n          value: CustomElement\n        }\n      }\n    );\n\n    CustomElement.prototype.connectedCallback = connectedCallback;\n    CustomElement.prototype.disconnectedCallback = disconnectedCallback;\n    CustomElement.prototype.attributeChangedCallback = attributeChangedCallback;\n\n    customElements.define(tag, CustomElement);\n    return CustomElement; // eslint-disable-line consistent-return\n  }\n}\n","/**\n * Camelize a hyphen-delimited string.\n */\nconst camelizeRE = /-(\\w)/g;\nexport const camelize = (str) => str.replace(camelizeRE, (_, c) => c ? c.toUpperCase() : ''); // eslint-disable-line arrow-parens, no-confusing-arrow\n\n/**\n * Hyphenate a camelCase string.\n */\nconst hyphenateRE = /([^-])([A-Z])/g;\nexport const hyphenate = str => str\n    .replace(hyphenateRE, '$1-$2')\n    .replace(hyphenateRE, '$1-$2')\n    .toLowerCase();\n\n/**\n * Convert an Array-like object to a real Array.\n */\nexport function toArray(list, start = 0) {\n  let i = list.length - start;\n  const ret = new Array(i);\n  while (i--) { // eslint-disable-line no-plusplus\n    ret[i] = list[i + start];\n  }\n  return ret;\n}\n\n","import { camelize, hyphenate } from './helpers';\n\n/**\n * Number and Boolean props are treated as strings\n * We should convert it so props will behave as intended\n * @param value\n * @returns {*}\n */\nexport function convertAttributeValue(value) {\n  let propsValue = value;\n  const isBoolean = ['true', 'false'].indexOf(value) > -1;\n  const valueParsed = parseFloat(propsValue, 10);\n  const isNumber = !isNaN(valueParsed) && isFinite(propsValue);\n\n  if (isBoolean) {\n    propsValue = propsValue === 'true';\n  } else if (isNumber) {\n    propsValue = valueParsed;\n  }\n\n  return propsValue;\n}\n\n/**\n * Extract props from component definition, no matter if it's array or object\n * @param componentDefinition\n * @param Vue\n */\nexport function getProps(componentDefinition = {}) {\n  const props = {\n    set: new Set(),\n    camelCase: [],\n    hyphenate: []\n  };\n\n  if (componentDefinition.mixins) {\n    componentDefinition.mixins.forEach((mixin) => {\n      if (!mixin.props) return;\n      (Array.isArray(mixin.props) ? mixin.props : Object.keys(mixin.props)).forEach((propName) => {\n        props.set.add(propName);\n      });\n    });\n  }\n  if (componentDefinition.extends && componentDefinition.extends.props) {\n    const { props: parentProps } = componentDefinition.extends;\n    (Array.isArray(parentProps) ? parentProps : Object.keys(parentProps)).forEach((propName) => {\n      props.set.add(propName);\n    });\n  }\n  if (componentDefinition.props) {\n    const compProps = componentDefinition.props;\n    (Array.isArray(compProps) ? compProps : Object.keys(compProps)).forEach((prop) => {\n      props.set.add(prop);\n    });\n  }\n  Array.from(props.set).forEach((prop) => {\n    props.camelCase.push(camelize(prop));\n    props.hyphenate.push(hyphenate(prop));\n  });\n\n  return props;\n}\n\n/**\n * If we get DOM node of element we could use it like this:\n * document.querySelector('widget-vue1').prop1 <-- get prop\n * document.querySelector('widget-vue1').prop1 = 'new Value' <-- set prop\n * @param element\n * @param props\n */\nexport function reactiveProps(element, props) {\n  // Handle param attributes\n  props.camelCase.forEach((name, index) => {\n    Object.defineProperty(element, name, {\n      get() {\n        return this.__vue_custom_element__[name];\n      },\n      set(value) {\n        if ((typeof value === 'object' || typeof value === 'function') && this.__vue_custom_element__) {\n          const propName = props.camelCase[index];\n          this.__vue_custom_element__[propName] = value;\n        } else {\n          this.setAttribute(props.hyphenate[index], convertAttributeValue(value));\n        }\n      }\n    });\n  });\n}\n\n/**\n * In root Vue instance we should initialize props as 'propsData'.\n * @param instanceOptions\n * @param componentDefinition\n * @param props\n */\nexport function getPropsData(element, componentDefinition, props) {\n  const propsData = componentDefinition.propsData || {};\n\n  props.hyphenate.forEach((name, index) => {\n    const value = element.attributes[name] && element.attributes[name].nodeValue;\n\n    if (value !== undefined && value !== '') {\n      propsData[props.camelCase[index]] = convertAttributeValue(value);\n    }\n  });\n\n  return propsData;\n}\n","import { toArray } from './helpers';\n\n/**\n * Get attributes of given node\n * @param children\n * @param Vue\n * @returns {*}\n */\nexport function getAttributes(children) {\n  const attributes = {};\n\n  toArray(children.attributes).forEach((attribute) => {\n    attributes[attribute.nodeName === 'vue-slot' ? 'slot' : attribute.nodeName] = attribute.nodeValue;\n  });\n\n  return attributes;\n}\n\n/**\n * Helper utility returning slots for render function\n * @param children\n * @param createElement\n * @param Vue\n */\nexport function getSlots(children = [], createElement) {\n  const slots = [];\n  toArray(children).forEach((child) => {\n    if (child.nodeName === '#text') {\n      if (child.nodeValue.trim()) {\n        slots.push(createElement('span', child.nodeValue));\n      }\n    } else {\n      const attributes = getAttributes(child);\n      const elementOptions = {\n        attrs: attributes,\n        domProps: {\n          innerHTML: child.innerHTML\n        }\n      };\n\n      if (attributes.slot) {\n        elementOptions.slot = attributes.slot;\n        attributes.slot = undefined;\n      }\n\n      slots.push(createElement(child.tagName, elementOptions));\n    }\n  });\n\n  return slots;\n}\n","/**\n * customEvent ponyfill\n * @param eventName\n * @param params\n * @returns {*}\n */\nexport default function customEvent(eventName, detail) {\n  const params = Object.assign({ bubbles: false, cancelable: false, detail });\n  let event;\n  if (typeof window.CustomEvent === 'function') {\n    event = new CustomEvent(eventName, params);\n  } else {\n    event = document.createEvent('CustomEvent');\n    event.initCustomEvent(eventName, params.bubbles, params.cancelable, params.detail);\n  }\n  return event;\n}\n\n/**\n * customEmit - emit customEvent\n * @param element\n * @param eventName\n * @param params\n * @returns {*}\n */\nexport function customEmit(element, eventName, ...args) {\n  const event = customEvent(eventName, [...args]);\n  element.dispatchEvent(event);\n}\n","import { getPropsData, reactiveProps } from './props';\nimport { getSlots } from './slots';\nimport { customEmit } from './customEvent';\n\n/**\n * Create new Vue instance if it's not already created\n * (like when opening modal and moving element around DOM)\n * @param element\n * @param Vue\n * @param componentDefinition\n * @param props\n * @param options\n */\nexport default function createVueInstance(element, Vue, componentDefinition, props, options) {\n  if (!element.__vue_custom_element__) {\n    const ComponentDefinition = Vue.util.extend({}, componentDefinition);\n    const propsData = getPropsData(element, ComponentDefinition, props);\n    const vueVersion = (Vue.version && parseInt(Vue.version.split('.')[0], 10)) || 0;\n\n    // element.addEventListener('change-event', (event) => { console.info('[Custom Event]', event.detail); }); // eslint-disable-line\n\n    // Auto event handling based on $emit\n    let ctorOptions = {}; // adjust vue-loader cache object if necessary - https://github.com/vuejs/vue-loader/issues/83\n    if (ComponentDefinition._Ctor) { // eslint-disable-line no-underscore-dangle\n      ctorOptions = ComponentDefinition._Ctor[0].options;  // eslint-disable-line no-underscore-dangle\n    }\n    ComponentDefinition.methods = ctorOptions.methods = ComponentDefinition.methods || {}; // eslint-disable-line no-multi-assign\n    ComponentDefinition.methods.$emit = ctorOptions.methods.$emit = function emit(...args) { // eslint-disable-line no-multi-assign\n      customEmit(element, ...args);\n      this.__proto__.$emit.call(this, ...args); // eslint-disable-line no-proto\n    };\n\n    let rootElement;\n\n    /**\n     * Developement ENV - will be removed in production build\n     */\n    if (vueVersion >= 2) {\n      const elementOriginalChildren = element.cloneNode(true).childNodes; // clone hack due to IE compatibility\n      // Vue 2+\n      rootElement = {\n        propsData,\n        props: props.camelCase,\n        computed: {\n          reactiveProps() {\n            const reactivePropsList = {};\n            props.camelCase.forEach((prop) => {\n              reactivePropsList[prop] = this[prop];\n            });\n\n            return reactivePropsList;\n          }\n        },\n        /* eslint-disable */\n        render(createElement) {\n          const data = {\n            props: this.reactiveProps\n          };\n\n          return createElement(\n            ComponentDefinition,\n            data,\n            getSlots(elementOriginalChildren, createElement)\n          );\n        }\n        /* eslint-enable */\n      };\n    } else if (vueVersion === 1) {\n      // Fallback for Vue 1.x\n      rootElement = ComponentDefinition;\n      rootElement.propsData = propsData;\n    } else {\n      // Fallback for older Vue versions\n      rootElement = ComponentDefinition;\n      const propsWithDefault = {};\n      Object.keys(propsData)\n        .forEach((prop) => {\n          propsWithDefault[prop] = { default: propsData[prop] };\n        });\n      rootElement.props = propsWithDefault;\n    }\n\n    const elementInnerHtml = vueVersion >= 2 ? '<div></div>' : `<div>${element.innerHTML}</div>`.replace(/vue-slot=/g, 'slot=');\n    if (options.shadow && element.shadowRoot) {\n      element.shadowRoot.innerHTML = elementInnerHtml;\n      rootElement.el = element.shadowRoot.children[0];\n    } else {\n      element.innerHTML = elementInnerHtml;\n      rootElement.el = element.children[0];\n    }\n\n    reactiveProps(element, props);\n\n    // Define the Vue constructor to manage the element\n    element.__vue_custom_element__ = new Vue(rootElement);\n    if (options.shadow && options.shadowCss && element.shadowRoot) {\n      const style = document.createElement('style');\n      style.type = 'text/css';\n      style.appendChild(document.createTextNode(options.shadowCss));\n\n      element.shadowRoot.appendChild(style);\n    }\n    element.removeAttribute('vce-cloak');\n    element.setAttribute('vce-ready', '');\n    customEmit(element, 'vce-ready');\n  }\n}\n","import registerCustomElement from './utils/registerCustomElement';\nimport createVueInstance from './utils/createVueInstance';\nimport { getProps, convertAttributeValue } from './utils/props';\nimport { camelize } from './utils/helpers';\n\nfunction install(Vue) {\n  Vue.customElement = function vueCustomElement(tag, componentDefinition, options = {}) {\n    const isAsyncComponent = typeof componentDefinition === 'function';\n    const optionsProps = isAsyncComponent && { props: options.props || [] };\n    const props = getProps(isAsyncComponent ? optionsProps : componentDefinition);\n    // register Custom Element\n    const CustomElement = registerCustomElement(tag, {\n      constructorCallback() {\n        typeof options.constructorCallback === 'function' && options.constructorCallback.call(this);\n      },\n\n      connectedCallback() {\n        const asyncComponentPromise = isAsyncComponent && componentDefinition();\n        const isAsyncComponentPromise = asyncComponentPromise && asyncComponentPromise.then && typeof asyncComponentPromise.then === 'function';\n\n        if (isAsyncComponent && !isAsyncComponentPromise) {\n          throw new Error(`Async component ${tag} do not returns Promise`);\n        }\n        if (!this.__detached__) {\n          if (isAsyncComponentPromise) {\n            asyncComponentPromise.then((lazyLoadedComponent) => {\n              const lazyLoadedComponentProps = getProps(lazyLoadedComponent);\n              createVueInstance(this, Vue, lazyLoadedComponent, lazyLoadedComponentProps, options);\n            });\n          } else {\n            createVueInstance(this, Vue, componentDefinition, props, options);\n          }\n        }\n\n        this.__detached__ = false;\n      },\n\n      /**\n       *  When using element in e.g. modal, it's detached and then attached back to document.\n       *  It will be unfortunate if we will destroy Vue instance when it happens.\n       *  That's why we detect if it's permament using setTimeout\n       */\n      disconnectedCallback() {\n        this.__detached__ = true;\n        typeof options.disconnectedCallback === 'function' && options.disconnectedCallback.call(this);\n\n        setTimeout(() => {\n          if (this.__detached__ && this.__vue_custom_element__) {\n            this.__vue_custom_element__.$destroy(true);\n          }\n        }, options.destroyTimeout || 3000);\n      },\n\n      /**\n       * When attribute changes we should update Vue instance\n       * @param name\n       * @param oldVal\n       * @param value\n       */\n      attributeChangedCallback(name, oldValue, value) {\n        if (this.__vue_custom_element__ && typeof value !== 'undefined') {\n          const nameCamelCase = camelize(name);\n          typeof options.attributeChangedCallback === 'function' && options.attributeChangedCallback.call(this, name, oldValue, value);\n          this.__vue_custom_element__[nameCamelCase] = convertAttributeValue(value);\n        }\n      },\n\n      observedAttributes: props.hyphenate,\n\n      shadow: !!options.shadow && !!HTMLElement.prototype.attachShadow\n    });\n\n    return CustomElement;\n  };\n}\n\nexport default install;\n\nif (typeof window !== 'undefined' && window.Vue) {\n  window.Vue.use(install);\n  if (install.installed) {\n    install.installed = false;\n  }\n}\n"],"names":["Object","setPrototypeOf","obj","proto","__proto__","bind","isES2015","Symbol","Reflect","registerCustomElement","tag","options","customElements","constructorCallback","shadow","HTMLElement","prototype","attachShadow","mode","call","connectedCallback","disconnectedCallback","attributeChangedCallback","name","oldValue","value","CustomElement","self","me","observedAttributes","define","create","camelizeRE","camelize","str","replace","_","c","toUpperCase","hyphenateRE","hyphenate","toLowerCase","toArray","list","start","i","length","ret","Array","convertAttributeValue","propsValue","isBoolean","indexOf","valueParsed","parseFloat","isNumber","isNaN","isFinite","getProps","componentDefinition","props","Set","mixins","forEach","mixin","isArray","keys","propName","set","add","extends","parentProps","compProps","prop","from","camelCase","push","reactiveProps","element","index","defineProperty","__vue_custom_element__","setAttribute","getPropsData","propsData","attributes","nodeValue","undefined","getAttributes","children","attribute","nodeName","getSlots","createElement","slots","child","trim","elementOptions","innerHTML","slot","tagName","customEvent","eventName","detail","params","assign","bubbles","cancelable","event","window","CustomEvent","document","createEvent","initCustomEvent","customEmit","args","dispatchEvent","createVueInstance","Vue","ComponentDefinition","util","extend","vueVersion","version","parseInt","split","ctorOptions","_Ctor","methods","$emit","emit","rootElement","elementOriginalChildren","cloneNode","childNodes","reactivePropsList","data","propsWithDefault","default","elementInnerHtml","shadowRoot","el","shadowCss","style","type","appendChild","createTextNode","removeAttribute","install","customElement","vueCustomElement","isAsyncComponent","optionsProps","asyncComponentPromise","isAsyncComponentPromise","then","Error","__detached__","lazyLoadedComponent","lazyLoadedComponentProps","$destroy","destroyTimeout","nameCamelCase","use","installed"],"mappings":"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"}